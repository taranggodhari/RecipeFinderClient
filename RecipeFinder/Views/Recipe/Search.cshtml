@model IEnumerable<RecipeFinder.Models.Recipe>

@{
	ViewData["Title"] = "Search";
}
<script src="https://code.jquery.com/jquery-3.3.1.js"
		integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60="
		crossorigin="anonymous"></script>
<h2>Search Results</h2>
<hr />
@*<p>
		<a asp-action="Create">Create New</a>
	</p>*@
<div class="container">
	<div class="row">
		@foreach (var item in Model)
		{
			<div class="col-md-3 col-sm-6">
				<div class="card" style="width: 20rem; height:38rem;">
					<img class="card-img-top img-responsive" src=@Html.DisplayFor(modelItem => item.image) alt=" @Html.DisplayNameFor(model => model.label)">
					<span class="card-title">@Html.DisplayFor(modelItem => item.label)</span>
					<div class="card-body">
						<div class="itemdata">
							<a class="cal" target="_blank" href=@Html.DisplayFor(modelItem => item.url)>
								@{
									int calories = (int)item.calories / (int)item.yield;
									int ingredientscount = item.ingredients.Count();
								}
								<span class="num">@calories</span>
								<span class="lbl">cal<span>ories</span></span>
							</a>
							<a class="ing" target="_blank" href=@Html.DisplayFor(modelItem => item.url)>
								<span class="num">@ingredientscount</span>
								<span class="lbl">ingr<span>edients</span></span>
							</a>
						</div>
						<div class="providersource">
							<a href=@Html.DisplayFor(modelItem => item.url) target="_blank">@Html.DisplayFor(modelItem => item.source)</a>
						</div>
						<div class="savediv">
							<form action="@Url.Action("SaveRecipe", "Recipe", new { rid = item.Id})" method="POST">
								@*<input type="hidden" name="recipeid" value="@Html.DisplayFor(modelItem => item.Id)">*@
								<button type="submit" class="btn btn-success savebutton">Save</button>
							</form>
							@*<form method="post" id="saverecipe">
									<input type="hidden" name="recipeid" value="@Html.DisplayFor(modelItem => item.Id)">
									<button type="submit" class="btn btn-success savebutton">Save</button>
								</form>*@
						</div>
					</div>
				</div>
			</div>
		}
	</div>
</div>
<script>
	$(document).ready(function () {

		$('#saverecipe').submit(function (e) {
			e.preventDefault();
			var id = $('#saverecipe').prop("recipeid").value;
			$.ajax({
				url: '@Url.Action("SaveRecipe", "Recipe")',
				type: "POST",
				data: id,
				contentType: false,
				processData: false,
				success: function (result) {
					var res = result;
				},
				error: function (result) {
					var res = result;
				}
			});
		});
	});
</script>

